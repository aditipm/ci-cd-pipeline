- pipeline: "buddy-ci"
  on: "EVENT"
  events:
  - type: "PUSH"
    refs:
    - "refs/heads/master"
  priority: "NORMAL"
  auto_clear_cache: true
  fail_on_prepare_env_warning: true
  actions:
  - action: "Build Docker image"
    type: "DOCKERFILE"
    dockerfile_path: "Dockerfile"
    buildkit: true
    target_platform: "linux/amd64"
  - action: "Kubernetes - deployment apply"
    type: "KUBERNETES_APPLY"
    auth_type: "TOKEN"
    server: "https://omkar.ml:9090/k8s/clusters/c-m-svbc7zb5"
    config_path: "k8s-deployment.yaml"
    kubectl_version: "latest"
    validate: true
    record_arg: "NOT_SET"
    overwrite_arg: true
    cascade: "BACKGROUND"
    grace_period_arg: 30
    token: "secure!Ax52wCnksPye8cSgkMxGrTm541XDyH30TsbVQvwc+EpGkt91dcesU5ZddfbN3IPou2P7TIi/MGMmrTbEPm/ergedTzWgDObVpPhqEDJOOltu/SgYEzyKXbmnJ4e/TGUY.12DDpda9yv+WVjk3TmAa1Q=="
  - action: "Sleep 15 seconds"
    type: "SLEEP"
    trigger_time: "ON_FAILURE"
    sleep_in_sec: 15
